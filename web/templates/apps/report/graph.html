{% extends "apps/report/report_base_wide.html" %}

{% block extrahead %}
    <script language="javascript" type="text/javascript" src="/site_media/js/arbor/jquery-1.6.2.min.js"></script>
    <script language="javascript" type="text/javascript" src="/site_media/js/arbor/arbor.js" ></script>
    <script language="javascript" type="text/javascript" src="/site_media/js/arbor/graphics.js" ></script>
    <script language="javascript" type="text/javascript" src="/site_media/js/arbor/renderer.js" ></script>
{%  endblock %}

{% block report_leftside %}

 <ul class="tabs">
    <li><a href="/file/{{ file.id }}/show">Info</a></li>
    <li class="active"><a href="/file/{{ result.id }}/related">Related</a></li>
    <!-- <li class="active"><a href="/file/{{ file.id }}/graph">Graph</a></li> -->
    <li><a href="/file/{{ file.id }}/wiki">Docs</a></li>
    <a href="/file/{{ file.id }}/related" class="btn error right">Cancel</a>
</ul>

<div class="span16">
    <canvas id="viewport" width="960" height="600"></canvas>
    <script language="javascript" type="text/javascript">
        $(document).ready(function() {
            $('body').bind('foobar', function(event, node) {
                $.getJSON("/arbor?n="+node.data.id, function(data) {
                    sys.graft(data);
                });
            });
            //var sys = arbor.ParticleSystem({repulsion:2000, stiffness:512, friction:0.2, gravity: false, dt:0.1});
            var sys = arbor.ParticleSystem({stiffness:100, friction:.5, gravity:!0, fps:30,dt:.015, precision:.5});
            sys.screenPadding(50);
            sys.renderer = Renderer("#viewport");
            var data = $.getJSON("/arbor?n={{ file.graph_id }}", function(data) {
                sys.graft(data);
            });
        });
    </script>
</div>

{% endblock %}
